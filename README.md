# SOC Detection Lab (Docker-Based)

## Overview
This lab simulates a small SOC environment using Docker:

- `target-web`: Nginx web server acting as a victim
- `attacker`: Kali-based attacker container used to generate malicious traffic (nmap scans, repeated requests)
- `log-analyzer-api`: Python/Flask mini-SIEM that ingests Nginx logs from a shared volume and exposes detections via a JSON API

## Objectives
- Practice log collection and centralized analysis
- Build basic detection logic for web/port scans
- Understand how attacker behavior shows up in logs
- Document detections and map them to MITRE ATT&CK techniques

## Architecture
Attacker â†’ Target â†’ Logs â†’ Detection:

- The `attacker` container sends nmap and curl traffic to `target-web`
- `target-web` writes access logs to `/var/log/nginx`
- Logs are shared via a Docker volume (`./nginx_logs`)
- `log-analyzer-api` reads the shared logs from `/logs`
- Detection logic identifies IPs with noisy activity and raises alerts on `/alerts`

## How to Run

```bash
# from the soc-detection-lab folder
docker compose up -d

# open the mini-SIEM API
http://localhost:4100/

# generate attack traffic
docker exec -it attacker /bin/bash
apt update && apt install -y nmap curl
nmap -sS target-web
for i in {1..200}; do curl http://target-web >/dev/null 2>&1; done
exit

ğŸ“˜ SOC Detection Lab â€” Docker-Based Home Lab
ğŸ” Overview

This project simulates a small-scale Security Operations Center (SOC) environment using Docker containers to replicate attacker activity, log collection, and custom detection logic.

It demonstrates hands-on experience with:

Log analysis

Detection engineering

Containerized environments

MITRE ATT&CK mapping

Basic threat simulation

Python/Flask API development

This lab is designed to replicate real-world SOC workflows in a lightweight and portable setup.

ğŸ§© Architecture
+------------------------+            +---------------------------+
|       Attacker         |  --->      |       Target Web Server   |
| (Kali-based container) |   traffic  | (Nginx container, logs)   |
+------------------------+            +---------------------------+
                                              |
                                              | Shared Volume
                                              v
                                      +------------------------+
                                      |  Log Analyzer API      |
                                      | (Custom Python SIEM)   |
                                      +------------------------+

Components
Container	Purpose
attacker	Generates malicious or noisy traffic (nmap scans, curl loops)
target-web	Nginx server receiving/recording requests in access logs
log-analyzer-api	Custom Python/Flask service that ingests logs and raises alerts
ğŸ¯ Objectives

This project demonstrates the following skills:

ğŸ”¹ Log parsing & centralized log collection

ğŸ”¹ Building detection rules based on log patterns

ğŸ”¹ Identifying indicators of scanning & enumeration

ğŸ”¹ Writing and exposing detections via API endpoints

ğŸ”¹ MITRE ATT&CK mapping to real techniques

ğŸ”¹ Technical documentation & incident reporting

ğŸ”¹ Docker networking & container management

These are core responsibilities for SOC analysts, detection engineers, and blue-team roles.

ğŸ› ï¸ Setup Instructions
1. Clone or download the repository
git clone https://github.com/USERNAME/soc-detection-lab.git
cd soc-detection-lab

2. Start the lab
docker compose up -d


Containers:

log-analyzer-api â†’ http://localhost:4100

target-web â†’ accessible via Docker network

attacker â†’ interactive shell

3. Confirm the SIEM API is running

Visit:

http://localhost:4100/


You should see:

{"message": "Log Analyzer API running. Go to /alerts to see detections."}

âš”ï¸ Simulating Attacks (from attacker container)

Enter the attacker container:

docker exec -it attacker /bin/bash


Install tools:

apt update && apt install -y nmap curl

Run a stealth scan:
nmap -sS target-web

Run noisy enumeration:
for i in {1..200}; do curl http://target-web >/dev/null 2>&1; done


Exit:

exit

ğŸš¨ View Detections

Check SIEM alerts:

http://localhost:4100/alerts


Example output:

[
  {
    "type": "POTENTIAL_PORT_OR_WEB_SCAN",
    "source_ip": "172.23.0.2",
    "event_count": 200,
    "description": "High number of hits from 172.23.0.2, possible scan or enumeration."
  }
]


This alert was generated by the custom detection logic analyzing Nginx access logs.

ğŸ§  MITRE ATT&CK Mapping
Behavior	MITRE Technique	Description
Web/Port Scan	T1046 â€“ Network Service Scanning	The attacker probes open ports and services using Nmap
Active Enumeration	T1595 â€“ Active Scanning	High-volume HTTP requests simulate reconnaissance
ğŸ“‚ Project Structure
soc-detection-lab/
â”‚â”€â”€ app/
â”‚   â”œâ”€â”€ app.py              # Python mini-SIEM / detection engine
â”‚   â””â”€â”€ requirements.txt
â”‚â”€â”€ logs/                   # (unused placeholder)
â”‚â”€â”€ nginx_logs/             # Shared log volume from target-web
â”‚â”€â”€ docker-compose.yml
â”‚â”€â”€ README.md               # This documentation

ğŸ“ˆ Skills Demonstrated

SIEM fundamentals

Detection engineering (Python)

Container networking (Docker)

Threat simulation (nmap, curl)

Log analysis (Nginx access logs)

MITRE ATT&CK mapping

Technical writing/documentation

Shell scripting & Linux basics

This project showcases the ability to build, attack, detect, and document a realistic SOC scenario.

ğŸš§ Future Enhancements (TODO)

Add brute-force detection

Add suspicious user-agent detection

Create an HTML dashboard for alerts

Add more attacker techniques (SQLi, directory bruteforce)

Write full multi-incident reports

ğŸ Status

âœ… Working MVP
â¡ï¸ Next Step: Incident Report + Additional Detection

## ğŸ“Š Mini SIEM Dashboard

Below is a live view of the Mini SIEM dashboard that visualizes alerts generated by the detection engine.

![Mini SIEM Dashboard](dashboard.png)

